<html>

<head>


    <title>剑皇网站</title>

    <link rel="stylesheet" type="text/css" href="css/common.css?v=19" />
    <script type="text/javascript" src="http://cdn.static.runoob.com/libs/jquery/1.10.2/jquery.min.js"></script>
    <script type="text/javascript">
        $(function () {
            //scan()
            var la = $("#large");
            la.hide();
            /*  
            鼠标移至预览图显示大图  
            */
            $("#previewImg").mousemove(function (e) {
                la.css({
                    top: e.pageY,
                    left: e.pageX
                }).html('<img src = "' + this.src + '" />').show();
            }).mouseout(function () {
                la.hide();
            });
        });

        function scan(fileName) {
            $("#scan").addClass("scan_red")
            $("#scan").animate({
                left: "+=1000px"
            }, 500, "linear", function () {
                $(this).css({
                    left: "-100px"
                });
            });
            /*
            setInterval(function () {
                $("#scan").animate({
                    left: "+=5000px"
                }, 1000, function () {
                    $(this).css({
                        left: "-300px"
                    });
                });
            }, 1000 * 20);
            */
            setTimeout(function () {
                $("#scan").addClass("scan_yellow");
            }, 250)
            setTimeout(function () {
                $("#scan").removeClass("scan_yellow");
                $("#scan").removeClass("scan_red");
            }, 500)
             setTimeout(function () {
                $("#scan").removeClass("scan_yellow");
                $("#scan").removeClass("scan_red");
                showMessage(fileName)
            }, 1500)
        }
        /*使用js实现文件上传图片的预览  
         */
        function showPreview(obj) {
             $("#message").html("")
             document.body.style.backgroundColor = "#ffffff"
            var pic = document.getElementById("previewImg");
            var file = document.getElementById("myfile");
            html5Reader(file, pic);
        }
        /*  
        firefox3.6+ chrome6+ Safari5.2+ Opera11+及IE10浏览器支持FileReader对象  
        其他兼容方法 http://www.2cto.com/kf/201402/281430.html  
        */
        function html5Reader(file, pic) {
            var file = file.files[0];
            var mess = ""
            var reader = new FileReader();
          
            scan(file.name)
            
            reader.readAsDataURL(file);
            reader.onload = function (e) {
                pic.src = this.result;
            }
        }

        function showMessage(mess) {
            if (checkname(mess)) {
                document.body.style.backgroundColor = "#ff0000"
                mess = "警告！！黄图！！"
                $("#message").addClass("white")
            } else {
                document.body.style.backgroundColor = "#ffffff"
                mess = "正经图"
                $("#message").removeClass("white")
            }
            $("#message").html(mess)
        }

        function checkname(name) {
            var reg = /.*[\u4e00-\u9fa5]+.*$/
            var strExp = new RegExp(reg);
            if (strExp.test(name)) {
                return true;
            } else {
                return false;
            }
        }
    </script>
</head>

<body>
    <h1 style="text-align:center;font-size:70px">剑皇网站</h1>
    <div>
        <h2>剑皇霸业！！</h2>
    </div>
    <div id="scan" width="300" height="300"></div>
    <div>
        <img id="previewImg" src="nopic.png" width="300" height="300" style="border-style:solid;border-color:black;" />
    </div>
    <form action="uploadServlet.do" method="post" enctype="multipart/form-data" style="font-size:20px">
        请选择图片：<input id="myfile" name="myfile" type="file" onchange="showPreview(this)" />
    </form>

    <div id="large"></div>
    <div id="mess">
        <p id="message"></p>
    </div>

    <p style="text-align:right">auth:ambrella</p>
</body>

</html>